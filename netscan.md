## Intro

Script for scanning the network noth by arp and icmp:

```bash
sudo python3 netscan.py -t 192.168.1.0/24
[*] Mapeo de la red:
	192.168.1.1: 1c:64:99:ef:98:de
	192.168.1.134: 08:00:27:aa:cc:d6
	192.168.1.147: 9c:53:22:a6:6e:66
	192.168.1.128: b4:e2:65:a6:fa:ab
	192.168.1.129: d4:f5:47:b6:af:66
	192.168.1.132: b8:ab:62:a4:a6:66
	192.168.1.131
	192.168.1.139
	192.168.1.141
[DBG]: Tiempo de ejecucion: 4.189150094985962
```

-----------------------------------------

## Script netscan.py

```python
#!/usr/bin/env python3
import socket, argparse, threading, sys, time, signal, re, subprocess
from termcolor import colored as color
from concurrent.futures import ThreadPoolExecutor
import scapy.all as scapy
 
def def_handler(sig, frame): 
    print(color("[*] Saliendo...", "yellow")); sys.exit(1)
signal.signal(signal.SIGINT, def_handler)
 
def get_arguments():
    parser = argparse.ArgumentParser(description='Fast TCP Port Scanner')
    parser.add_argument("-t", "--target", dest="target", help="Network to scan: ")
    options = parser.parse_args() 
    if options.target is None: 
        parser.print_help(); sys.exit(1)     
    return options.target
     
def host_discovery(target):
    try:
        ping = subprocess.run(["ping", "-c", "1", target], timeout=1, stdout=subprocess.DEVNULL)
        if ping.returncode == 0:
            return target
    except subprocess.TimeoutExpired:
        pass 
 
def arp_discovery(target):
    arp_packet = scapy.ARP(pdst=target); broad_packet = scapy.Ether(dst="ff:ff:ff:ff:ff:ff")
    arp_packet = broad_packet/arp_packet
    answered, _ = scapy.srp(arp_packet, timeout=1, verbose=False); results = {}
    for _, resp in answered:
        ip = resp[scapy.ARP].psrc; mac = resp[scapy.ARP].hwsrc; results[ip] = mac
    return results
 
target = get_arguments(); splitted = target.split(".") start = time.time();
 
first_octets = '.'.join(splitted[:3]); last_octet = ".0/24"; 
targets = [f"{first_octets}.{last_octet}" for last_octet in range(1, 255)]; active_ips = []
results = arp_discovery(f"{first_octets}.0/24");
 
with ThreadPoolExecutor(max_workers=100) as executor:
    active_ips = list(filter(None, executor.map(host_discovery, targets)))
results2 = [ip for ip in active_ips if ip not in results]
 
print(color(f"[*] Mapeo de la red:", 'yellow'))
[print(f"\t{ip}: {mac}") for ip, mac in results.items()]; [print(f"\t{ip}") for ip in results2]
end = time.time(); print(color(f"[DBG]: Tiempo de ejecucion: {end - start}", "yellow"))